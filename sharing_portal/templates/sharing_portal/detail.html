{% extends 'layout/default.html' %}
{% load i18n cms_tags markdown_deux_tags staticfiles pipeline bootstrap3 %}
{% block title %}Sharing Portal | Chameleon Cloud {% endblock %}

{% block styles %}
{{ block.super }}
<link rel="stylesheet" type="text/css" href="{% static 'sharing_portal/artifacts.css' %}">
{% endblock %}

{% block content %}
{# Experiments / [current_exp_title] subheader #}
<ol class="breadcrumb">
  <li>
    <a href="{% url 'sharing_portal:index_all' %}">Artifacts</a>
  </li>
  <li class="active">{{ artifact.title }}</li>
</ol>

<div class="layoutGrid">
  <div class="layoutGrid__main">
    <div class="artifactDetail">
      <header class="artifactDetail__heading">
        <h2 class="artifactTitle">{{ artifact.title }}</h2>
        <div class="artifactActions">
          {% if editable %}
          <a class="btn btn-warning" href="{% url 'sharing_portal:edit' artifact.pk %}">
            <i class="fa fa-edit"></i> Edit
          </a>
          {% endif %}
        </div>
      </header>
      <div class="artifactBody">
        <section class="artifactBody__description">
          {{ artifact.description|markdown|safe }}
        </section>

        {% include 'sharing_portal/includes/stats.html' with artifact=artifact %}

        {% if artifact.authors.all %}
        <section class="artifactBody__authors">
          <h4>Authors</h4>
          <ul>
          {% for author in artifact.authors.all %}
            <li>{{ author }}</li>
          {% endfor %}
          </ul>
        </section>
        {% endif %}

        {% if version and version.zenodo_link %}
        <section>
          <h4>Digital Object Identifier (DOI)</h4>
          <a href="{{ version.zenodo_link }}" target="_blank">{{ version.doi }}</a> ({{ version.created_at }})
        </section>
        {% endif %}

        {% if artifact.git_repo %}
        <a class="btn" href="https://github.com/{{ artifact.git_repo }}" target="_blank">
          <i class="fa fa-github"></i>&nbsp;GitHub: {{ artifact.git_repo }}
        </a>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="layoutGrid__side">
    <a class="artifactLaunchButton btn btn-primary" href="{{ artifact.jupyterhub_link }}" target="_blank">
      <i class="fa fa-external-link"></i> Launch with JupyterHub
    </a>

    <div class="artifactVersions">
      <h4>Versions</h4>
      <ol class="sidebarNav">
        {% for i, v in all_versions %}
        <li class="sidebarNav__item {% if version == v %}active{% endif %}">
          <a class="artifactVersion__link" href="{% url 'sharing_portal:detail_version' artifact.pk i %}">
            <span>Version {{ i }}</span>
            <span>{{ v.created_at }}</span>
          </a>
        </li>
        {% endfor %}
      </ol>
    </div>
  </div>
</div>
{% endblock %}
